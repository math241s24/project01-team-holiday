---
title: "Project Presentation"
subtitle: "Holiday Movies"
format: 
  revealjs
highlight-style: a11y
execute:
  code-link: true
  echo: true
editor_options: 
  chunk_output_type: console
---

## Introduction {.smaller}

* Our dataset: Holiday Movies
  * From TidyTuesday repository
  * Dimensions: 2265x14
  * Movies with "holiday", "Christmas", "Hanukkah", or "Kwanzaa" 
* We looked at trends relating to ratings, age, and run time of different holiday movies 
  * We chose this data set because we are interested in:
    * relationship between movie types and public reception of them
    * changes in movie style over time
    * whether the holiday the movies were written for played a role in this
```{r, echo = FALSE}
library(tidyr)
library(readr)
library(ggplot2)
holiday_movies <- read_csv("data/holiday_movies.csv")

new_holiday_movies <- pivot_longer(
  holiday_movies,
  cols = c("christmas", "hanukkah", "kwanzaa", "holiday"),
  names_to = "holidays",
  values_to = "true/false"
)

filtered_holiday_movies <- new_holiday_movies[new_holiday_movies$`true/false`, ]

filtered_holiday_movies$holidays <- factor(filtered_holiday_movies$holidays, levels = c("christmas", "hanukkah", "kwanzaa", "holiday"))
```
  

## Question 1 Graph 1 {.smaller}

* How does type of holiday affect a movie's rating, and for each holiday, how does the movie's age affect its rating?
  * We combined holidays into one column using pivot longer
  * Our first graph is a density plot showing the average rating density by movie type
```{r, echo = FALSE}
library(ggplot2)

ggplot(filtered_holiday_movies, aes(x = average_rating, 
                                    color = holidays)) +
  geom_density(size=1) +
  labs(title = "Holiday movies by rating frequency",
       x = "Average Rating",
       y = "Density",
       color = "Holiday in title") 
```
  * Kwanzaa highest ratings (sample size)
  * Hanukkah variance in ratings

## Question 1 Graph 2 {.smaller}

* Our second graph shows is aa scatterplot with line of best fit showing average rating by year for each holiday 
```{r, echo = FALSE}
ggplot(filtered_holiday_movies, aes(x = year, 
                                    y = average_rating, 
                                    color = holidays)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method="lm", 
              se = FALSE, 
              color = "gray36") +
  facet_wrap(~ holidays) +
  theme(axis.text.x = element_text(angle = 65, 
                                   vjust = 0.6)) + 
  labs(title = "Average Movie Rating by Year and Holiday",
       x = "Year", 
       y = "Average Rating",
       color = "Holiday in title")
```
  * Decrease in ratings overtime
  * Small samples for some holidays
  * Fairly consistant
  * OVERALL CONCLUSION




## Question 2 Graph 1 {.smaller} 

* How do movie run times vary over time? Have holiday movies gotten longer over time? Shorter? Is there a significant difference of run time over time?
  * Our first graph is a violin plot showing runtime by holiday
```{r, echo = FALSE}
library(dplyr)
Christmas <- filtered_holiday_movies %>%
  filter(holidays == "christmas") %>%
  filter(year >= 2000 & year <= 2023)

ggplot(filtered_holiday_movies, aes(x = runtime_minutes, y = holidays, fill = holidays))+
    geom_violin()+
  labs(title = "Runtime in Holiday movies",
    x = "Runtime (in minutes)",
    y = "",
    fill = "Title contains")
```

  * Kwanzaa movies short runtimes
  * Hanukkah next
  * Christmas have longest, concentration around 90 minutes 
  * holiday movies in general -> 90 minutes but have a wide range

## Question 2 Graph 2 {.smaller}

* Our second graph is a a scatterplot showing runtime by year and holiday
```{r, echo = FALSE}
ggplot(filtered_holiday_movies, aes(x = year, 
                                    y = runtime_minutes, 
                                    color = holidays)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method="lm", 
              se = FALSE, 
              color = "gray36") +
  facet_wrap(~ holidays) +
  theme(axis.text.x = element_text(angle = 65, 
                                   vjust = 0.6)) + 
  labs(title = "Movie Runtime by Year and Holiday",
       x = "Year", 
       y = "Runtime in minutes",
       color = "Holiday in movie title")
```

  * Runtime has increased slightly over the years
  * Stayed fairly consistent for holiday movies overall
  * OVERALL CONCLUSION

## Question 2 Linear Model {.smaller}

```{r}
library(moderndive)
holidays_lm <- lm(data = filtered_holiday_movies, runtime_minutes ~ year * holidays)
get_regression_table(holidays_lm)
```

